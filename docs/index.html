<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Mestre da Flauta - Edição Profissional</title>
    
    <!-- Bibliotecas Externas -->
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800;900&display=swap" rel="stylesheet">
    
    <style>
        :root { --app-height: 100dvh; }
        body { 
            font-family: 'Inter', sans-serif; 
            background-color: #0F172A; 
            color: #F8FAFC; 
            margin: 0; 
            overflow: hidden; 
            min-height: var(--app-height);
        }
        #root { height: var(--app-height); }
        .scroll-container {
            overflow-y: auto;
            height: 100%;
            scrollbar-width: thin;
            scrollbar-color: #1E293B transparent;
        }
        .note-block { transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1); border-width: 2px; flex-shrink: 0; }
        .note-block.active { 
            transform: scale(1.05); 
            border-color: #10B981; 
            background-color: #064E3B; 
            box-shadow: 0 0 25px rgba(16, 185, 129, 0.4); 
            color: #34D399;
        }
        .flute-hole { fill: #334155; stroke: #475569; stroke-width: 1.5; transition: fill 0.15s ease; }
        .flute-hole.closed { fill: #3B82F6; stroke: #DBEAFE; }
        
        /* Modais */
        .modal-overlay {
            background-color: rgba(2, 6, 23, 0.85);
            backdrop-filter: blur(8px);
            animation: fadeIn 0.3s ease;
        }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
        
        .modal-content {
            animation: slideUp 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
        }
        @keyframes slideUp { from { transform: translateY(20px); opacity: 0; } to { transform: translateY(0); opacity: 1; } }

        .no-select { user-select: none; -webkit-tap-highlight-color: transparent; }
        .no-scrollbar::-webkit-scrollbar { display: none; }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef, useMemo } = React;

        // --- COMPONENTE DE ÍCONE CUSTOMIZADO ---
        const Icon = ({ name, size = 24, className = "", fill = "none" }) => {
            const icons = {
                Play: <polygon points="5 3 19 12 5 21 5 3" fill={fill === "currentColor" ? "currentColor" : fill} />,
                X: <><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></>,
                ChevronRight: <polyline points="9 18 15 12 9 6"></polyline>,
                Music: <><path d="M9 18V5l12-2v13"></path><circle cx="6" cy="18" r="3"></circle><circle cx="18" cy="16" r="3"></circle></>,
                BookOpen: <><path d="M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z"></path><path d="M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z"></path></>,
                Award: <><circle cx="12" cy="8" r="7"></circle><polyline points="8.21 13.89 7 23 12 20 17 23 15.79 13.88"></polyline></>,
                ArrowLeft: <><line x1="19" y1="12" x2="5" y2="12"></line><polyline points="12 19 5 12 12 5"></polyline></>,
                RotateCcw: <><path d="M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8"></path><polyline points="3 3 3 8 8 8"></polyline></>,
                CheckCircle2: <><circle cx="12" cy="12" r="10"></circle><path d="m9 12 2 2 4-4"></path></>,
                Volume2: <><polygon points="11 5 6 9 2 9 2 15 6 15 11 19 11 5"></polygon><path d="M15.54 8.46a5 5 0 0 1 0 7.07"></path><path d="M19.07 4.93a10 10 0 0 1 0 14.14"></path></>,
                Mic2: <><path d="m12 8-9.04 9.06a2.82 2.82 0 1 0 3.98 3.98L16 12"></path><circle cx="17" cy="7" r="5"></circle></>,
                Star: <polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2" />,
                Trophy: <><path d="M6 9H4.5a2.5 2.5 0 0 1 0-5H6"></path><path d="M18 9h1.5a2.5 2.5 0 0 0 0-5H18"></path><path d="M4 22h16"></path><path d="M10 14.66V17c0 .55-.47.98-.97 1.21C7.85 18.75 7 20.24 7 22"></path><path d="M14 14.66V17c0 .55.47.98.97 1.21C16.15 18.75 17 20.24 17 22"></path><path d="M18 2H6v7a6 6 0 0 0 12 0V2Z"></path></>,
                Info: <><circle cx="12" cy="12" r="10"></circle><line x1="12" y1="16" x2="12" y2="12"></line><line x1="12" y1="8" x2="12.01" y2="8"></line></>,
                ThumbsUp: <><path d="M7 10v12"></path><path d="M15 5.88 14 10h5.83a2 2 0 0 1 1.92 2.56l-2.33 8A2 2 0 0 1 17.5 22H4a2 2 0 0 1-2-2v-8a2 2 0 0 1 2-2h2.76a2 2 0 0 0 1.79-1.11L12 2h0a3.13 3.13 0 0 1 3 3.88Z"></path></>
            };

            return (
                <svg 
                    xmlns="http://www.w3.org/2000/svg" 
                    width={size} 
                    height={size} 
                    viewBox="0 0 24 24" 
                    fill={fill === "currentColor" ? "currentColor" : "none"} 
                    stroke="currentColor" 
                    strokeWidth="2" 
                    strokeLinecap="round" 
                    strokeLinejoin="round" 
                    className={className}
                >
                    {icons[name]}
                </svg>
            );
        };

        const FREQS = { 'do_lat': 261.63, 're_lat': 293.66, 'mi_lat': 329.63, 'fa_lat': 349.23, 'sol_lat': 392.00, 'la_lat': 440.00, 'si_lat': 493.88 };
        const LABELS = { 'do_lat': 'Dó', 're_lat': 'Ré', 'mi_lat': 'Mi', 'fa_lat': 'Fá', 'sol_lat': 'Sol', 'la_lat': 'Lá', 'si_lat': 'Si' };
        const FINGERINGS = {
            'do_lat': [true, true, true, true, true, true, true, true],
            're_lat': [true, true, true, true, true, true, true, false],
            'mi_lat': [true, true, true, true, true, true, false, false],
            'fa_lat': [true, true, true, true, true, false, true, true],
            'sol_lat': [true, true, true, true, false, false, false, false],
            'la_lat': [true, true, true, false, false, false, false, false],
            'si_lat': [true, true, false, false, false, false, false, false]
        };

        const Modal = ({ isOpen, onClose, title, iconName, children }) => {
            if (!isOpen) return null;
            return (
                <div className="fixed inset-0 z-50 flex items-center justify-center p-4 modal-overlay">
                    <div className="bg-slate-900 border border-slate-800 w-full max-w-lg rounded-[2.5rem] overflow-hidden modal-content shadow-2xl">
                        <div className="flex justify-between items-center p-6 border-b border-slate-800 bg-slate-900/50">
                            <h3 className="text-xl font-bold flex items-center gap-3 text-white">
                                {iconName && <Icon name={iconName} className="text-emerald-400" size={24} />}
                                {title}
                            </h3>
                            <button onClick={onClose} className="p-2 hover:bg-slate-800 rounded-full transition-colors text-slate-400">
                                <Icon name="X" size={24} />
                            </button>
                        </div>
                        <div className="p-8 scroll-container max-h-[75dvh]">
                            {children}
                        </div>
                    </div>
                </div>
            );
        };

        const App = () => {
            const [view, setView] = useState('menu'); 
            const [levelIdx, setLevelIdx] = useState(0);
            const [exerciseIdx, setExerciseIdx] = useState(0);
            const [isPlaying, setIsPlaying] = useState(false);
            const [activeNoteIdx, setActiveNoteIdx] = useState(-1);
            const [audioReady, setAudioReady] = useState(false);
            
            // Novos Estados para Fluxo Pedagógico
            const [hasListened, setHasListened] = useState(false);
            const [showGuide, setShowGuide] = useState(false);
            const [lessonComplete, setLessonComplete] = useState(false);

            const audioCtx = useRef(null);

            const curriculum = useMemo(() => {
                const baseLevels = [
                    { id: 1, name: "Nível Dó", notes: ["do_lat"], dur: ["q", "h"], goal: "Embocadura firme e sopro contínuo no Dó grave." },
                    { id: 2, name: "Nível Ré", notes: ["do_lat", "re_lat"], dur: ["q", "h"], goal: "Coordenação básica do dedo anelar e transição suave." },
                    { id: 3, name: "Nível Mi", notes: ["do_lat", "re_lat", "mi_lat"], dur: ["q", "h"], goal: "Leitura de saltos entre as três notas iniciais." },
                    { id: 4, name: "Nível Fá", notes: ["do_lat", "re_lat", "mi_lat", "fa_lat"], dur: ["q", "8"], goal: "Introdução da colcheia e ritmo sincopado simples." },
                    { id: 5, name: "Nível Sol", notes: ["do_lat", "re_lat", "mi_lat", "fa_lat", "sol_lat"], dur: ["q", "8"], goal: "Domínio da mão esquerda e agilidade melódica." },
                    { id: 6, name: "Nível Lá", notes: ["do_lat", "re_lat", "mi_lat", "fa_lat", "sol_lat", "la_lat"], dur: ["q", "h"], goal: "Exercícios de fôlego e notas longas de apoio." },
                    { id: 7, name: "Nível Si", notes: ["do_lat", "re_lat", "mi_lat", "fa_lat", "sol_lat", "la_lat", "si_lat"], dur: ["q", "h", "8"], goal: "Escala diatônica completa de Dó Maior." }
                ];

                return baseLevels.map(lvl => {
                    const exList = [];
                    for (let i = 1; i <= 18; i++) {
                        const sequence = [];
                        const len = 4 + (i % 4);
                        for (let j = 0; j < len; j++) {
                            const isRest = j === len - 1 ? false : Math.random() < 0.1;
                            sequence.push({
                                n: isRest ? null : lvl.notes[Math.floor(Math.random() * lvl.notes.length)],
                                d: lvl.dur[Math.floor(Math.random() * lvl.dur.length)] === 'h' ? 2 : (lvl.dur[Math.floor(Math.random() * lvl.dur.length)] === '8' ? 0.5 : 1)
                            });
                        }
                        sequence[sequence.length - 1].n = lvl.notes[0];
                        sequence[sequence.length - 1].d = 2;

                        exList.push({
                            id: `L${lvl.id}-E${i.toString().padStart(2, '0')}`,
                            objective: i % 3 === 0 ? "Desafio de Fixação" : (i % 3 === 1 ? "Treino Rítmico" : "Coordenação Motora"),
                            sequence: sequence,
                            repose: lvl.notes[0]
                        });
                    }
                    return { ...lvl, exercises: exList };
                });
            }, []);

            const currentLevel = curriculum[levelIdx];
            const currentExercise = currentLevel.exercises[exerciseIdx];

            // Resetar estado ao mudar de exercício
            useEffect(() => {
                setHasListened(false);
                setActiveNoteIdx(-1);
            }, [exerciseIdx, levelIdx]);

            const initAudio = () => {
                if (!audioCtx.current) {
                    audioCtx.current = new (window.AudioContext || window.webkitAudioContext)();
                    setAudioReady(true);
                }
            };

            const playNote = (note, duration, startTime) => {
                if (!note || !FREQS[note]) return;
                const osc = audioCtx.current.createOscillator();
                const gain = audioCtx.current.createGain();
                osc.type = 'triangle';
                osc.frequency.setValueAtTime(FREQS[note], startTime);
                
                gain.gain.setValueAtTime(0, startTime);
                gain.gain.linearRampToValueAtTime(0.15, startTime + 0.04);
                gain.gain.setValueAtTime(0.15, startTime + duration - 0.05);
                gain.gain.linearRampToValueAtTime(0, startTime + duration);

                osc.connect(gain);
                gain.connect(audioCtx.current.destination);
                osc.start(startTime);
                osc.stop(startTime + duration);
            };

            const startExercise = async () => {
                if (!audioReady) initAudio();
                if (isPlaying) return;

                setIsPlaying(true);
                const beatUnit = 0.85; 
                let scheduleTime = audioCtx.current.currentTime + 0.2;

                currentExercise.sequence.forEach((item, idx) => {
                    const dur = item.d * beatUnit;
                    if (item.n) playNote(item.n, dur, scheduleTime);
                    
                    setTimeout(() => setActiveNoteIdx(idx), (scheduleTime - audioCtx.current.currentTime) * 1000);
                    scheduleTime += dur;
                });

                setTimeout(() => {
                    setIsPlaying(false);
                    setActiveNoteIdx(-1);
                    setHasListened(true); // Agora o aluno ouviu a referência
                }, (scheduleTime - audioCtx.current.currentTime) * 1000);
            };

            const nextLesson = () => {
                setLessonComplete(false);
                if (exerciseIdx < currentLevel.exercises.length - 1) {
                    setExerciseIdx(prev => prev + 1);
                } else if (levelIdx < curriculum.length - 1) {
                    setLevelIdx(prev => prev + 1);
                    setExerciseIdx(0);
                } else {
                    setView('menu');
                }
            };

            if (view === 'menu') {
                return (
                    <div className="scroll-container p-6 md:p-16 no-select">
                        <div className="max-w-6xl mx-auto">
                            <div className="flex flex-col md:flex-row justify-between items-center mb-16 gap-8 text-center md:text-left">
                                <div>
                                    <h1 className="text-6xl font-black text-emerald-500 mb-2 tracking-tighter uppercase">Mestre da Flauta</h1>
                                    <p className="text-slate-400 font-bold uppercase tracking-[0.3em] text-xs">
                                        Educação Musical Progressiva Profissional
                                    </p>
                                </div>
                                <button 
                                    onClick={() => setShowGuide(true)}
                                    className="flex items-center gap-3 bg-slate-900 hover:bg-slate-800 px-8 py-4 rounded-[1.5rem] font-bold transition-all border border-slate-800 shadow-lg text-emerald-400"
                                >
                                    <Icon name="BookOpen" size={20} /> Guia Técnico
                                </button>
                            </div>
                            
                            <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8 pb-32">
                                {curriculum.map((lvl, i) => (
                                    <div key={lvl.id} className="bg-slate-900/40 rounded-[3rem] p-8 border border-slate-800 hover:border-emerald-500/40 transition-all flex flex-col group shadow-2xl backdrop-blur-sm">
                                        <div className="flex justify-between items-start mb-6">
                                            <div className="bg-emerald-500/10 p-4 rounded-2xl text-emerald-400">
                                                <Icon name="Music" size={28} />
                                            </div>
                                            <span className="text-[10px] bg-slate-800 text-slate-500 px-4 py-2 rounded-xl font-black uppercase tracking-widest">
                                                {lvl.exercises.length} ETAPAS
                                            </span>
                                        </div>
                                        <h3 className="font-extrabold text-3xl text-white mb-3 tracking-tight">{lvl.name}</h3>
                                        <p className="text-slate-500 text-sm mb-10 leading-relaxed flex-1 italic">
                                            "{lvl.goal}"
                                        </p>
                                        <button 
                                            onClick={() => { setLevelIdx(i); setExerciseIdx(0); setView('player'); }}
                                            className="w-full bg-emerald-500 hover:bg-emerald-400 text-emerald-950 font-black py-5 rounded-2xl transition-all flex items-center justify-center gap-2 group-hover:translate-y-[-2px] shadow-lg shadow-emerald-900/20"
                                        >
                                            INICIAR <Icon name="ChevronRight" size={22} />
                                        </button>
                                    </div>
                                ))}
                            </div>
                        </div>

                        <Modal isOpen={showGuide} onClose={() => setShowGuide(false)} title="Manual do Aluno" iconName="Info">
                            <div className="space-y-10">
                                <section className="flex gap-4">
                                    <div className="bg-emerald-500/10 p-3 rounded-xl h-fit text-emerald-400"><Icon name="Volume2" size={24}/></div>
                                    <div>
                                        <h4 className="font-black text-white uppercase tracking-widest text-xs mb-2">1. Respiração e Postura</h4>
                                        <p className="text-slate-400 text-sm leading-relaxed">
                                            Mantenha as costas eretas e os pés no chão. Respire pelo diafragma (abdômen). Imagine que o ar é um fio de seda contínuo.
                                        </p>
                                    </div>
                                </section>
                                <section className="flex gap-4">
                                    <div className="bg-emerald-500/10 p-3 rounded-xl h-fit text-emerald-400"><Icon name="Mic2" size={24}/></div>
                                    <div>
                                        <h4 className="font-black text-white uppercase tracking-widest text-xs mb-2">2. A Articulação (Língua)</h4>
                                        <p className="text-slate-400 text-sm leading-relaxed">
                                            Para separar as notas, use a ponta da língua no céu da boca, pronunciando mentalmente a sílaba <strong>"Tu"</strong> suavemente.
                                        </p>
                                    </div>
                                </section>
                                <section className="flex gap-4">
                                    <div className="bg-emerald-500/10 p-3 rounded-xl h-fit text-emerald-400"><Icon name="Star" size={24}/></div>
                                    <div>
                                        <h4 className="font-black text-white uppercase tracking-widest text-xs mb-2">3. Notação por Blocos</h4>
                                        <p className="text-slate-400 text-sm leading-relaxed">
                                            Cada bloco colorido representa o tempo que a nota deve durar. Siga a indicação luminosa para garantir o ritmo perfeito.
                                        </p>
                                    </div>
                                </section>
                                <button 
                                    onClick={() => setShowGuide(false)}
                                    className="w-full bg-emerald-500 text-emerald-950 py-5 rounded-2xl font-black text-sm hover:bg-emerald-400 transition-colors mt-4"
                                >
                                    ESTOU PRONTO
                                </button>
                            </div>
                        </Modal>
                    </div>
                );
            }

            return (
                <div className="h-full flex flex-col p-4 md:p-12 no-select bg-slate-950 overflow-hidden">
                    <div className="max-w-6xl mx-auto w-full flex flex-col h-full">
                        
                        <div className="flex items-center gap-8 py-4 mb-8">
                            <button onClick={() => setView('menu')} className="p-4 bg-slate-900 rounded-[1.5rem] text-slate-500 hover:text-white transition-all shadow-xl border border-slate-800">
                                <Icon name="ArrowLeft" size={24} />
                            </button>
                            <div className="flex-1">
                                <div className="flex justify-between items-end mb-2 px-1">
                                    <span className="text-[10px] font-black text-slate-500 uppercase tracking-widest">Progresso no Nível</span>
                                    <span className="text-xs font-bold text-emerald-500">{exerciseIdx + 1} / {currentLevel.exercises.length}</span>
                                </div>
                                <div className="h-3 bg-slate-900 rounded-full overflow-hidden border border-slate-800 p-[2px]">
                                    <div 
                                        className="h-full bg-emerald-500 rounded-full progress-bar-fill shadow-[0_0_20px_rgba(16,185,129,0.4)]"
                                        style={{ width: `${((exerciseIdx + 1) / currentLevel.exercises.length) * 100}%` }}
                                    ></div>
                                </div>
                            </div>
                        </div>

                        <div className="flex-1 flex flex-col lg:flex-row gap-12 min-h-0 items-center justify-center">
                            
                            <div className="flex-1 w-full flex flex-col justify-center gap-12">
                                <div className="text-center lg:text-left">
                                    <div className="inline-flex items-center gap-2 bg-emerald-500/10 text-emerald-400 px-5 py-2 rounded-full text-[10px] font-black uppercase tracking-widest mb-6 border border-emerald-500/20">
                                        <Icon name="Award" size={16} /> Foco Técnico: {currentLevel.name}
                                    </div>
                                    <h2 className="text-4xl md:text-6xl font-black text-white leading-none tracking-tight">
                                        {currentExercise.objective}
                                    </h2>
                                    <p className="mt-4 text-slate-400 text-sm md:text-base italic">
                                        {hasListened ? "Ouça novamente ou confirme que está pronto para avançar." : "Primeiro, ouça a referência para memorizar o som e o ritmo."}
                                    </p>
                                </div>

                                <div className="w-full flex items-center gap-2 overflow-x-auto no-scrollbar py-10 px-4 bg-slate-900/20 rounded-[3rem]">
                                    {currentExercise.sequence.map((step, i) => (
                                        <div 
                                            key={i}
                                            className={`note-block rounded-[1.5rem] flex flex-col items-center justify-center font-black text-xs md:text-sm
                                                ${step.n ? 'bg-slate-900 border-slate-800 text-slate-400' : 'bg-transparent border-dashed border-slate-800 opacity-10'}
                                                ${activeNoteIdx === i ? 'active' : ''}
                                            `}
                                            style={{ 
                                                minWidth: `${step.d * 80}px`,
                                                height: step.n ? '80px' : '35px'
                                            }}
                                        >
                                            {step.n && <span className="text-[9px] opacity-40 mb-1 tracking-tighter">POSIÇÃO</span>}
                                            {step.n && LABELS[step.n].toUpperCase()}
                                        </div>
                                    ))}
                                </div>

                                {/* Ações Desktop */}
                                <div className="hidden lg:flex flex-col gap-4 max-w-sm">
                                    {!isPlaying ? (
                                        <button 
                                            onClick={startExercise}
                                            className="w-full bg-slate-800 hover:bg-slate-700 text-white font-black py-6 rounded-[2rem] text-xl transition-all flex items-center justify-center gap-4 border border-slate-700"
                                        >
                                            <Icon name="Volume2" size={28} /> {hasListened ? "OUVIR NOVAMENTE" : "OUVIR REFERÊNCIA"}
                                        </button>
                                    ) : (
                                        <div className="w-full py-6 text-center font-black text-emerald-500 bg-emerald-500/5 rounded-[2rem] border-2 border-emerald-500/20 animate-pulse text-xl tracking-[0.2em]">
                                            ESCUTE...
                                        </div>
                                    )}
                                    
                                    {hasListened && !isPlaying && (
                                        <button 
                                            onClick={() => setLessonComplete(true)}
                                            className="w-full bg-emerald-500 hover:bg-emerald-400 text-emerald-950 font-black py-7 rounded-[2rem] text-2xl shadow-[0_8px_0_#059669] hover:shadow-[0_6px_0_#059669] active:translate-y-1 transition-all flex items-center justify-center gap-4"
                                        >
                                            <Icon name="ThumbsUp" size={32} fill="currentColor" /> ESTOU PRONTO
                                        </button>
                                    )}
                                </div>
                            </div>

                            <div className="w-full lg:w-auto flex justify-center py-4">
                                <div className="bg-slate-900/80 p-14 lg:p-20 rounded-[6rem] border border-slate-800 shadow-2xl relative">
                                    <div className="absolute top-10 left-1/2 -translate-x-1/2 text-[10px] font-black text-slate-700 tracking-[0.8em] uppercase">
                                        Model S
                                    </div>
                                    <svg viewBox="0 0 100 240" className="w-[120px] lg:w-[160px] h-auto">
                                        <rect x="35" y="0" width="30" height="240" rx="15" fill="#1E293B" />
                                        <circle 
                                            className={`flute-hole ${activeNoteIdx >= 0 && currentExercise.sequence[activeNoteIdx].n && FINGERINGS[currentExercise.sequence[activeNoteIdx].n][0] ? 'closed' : ''}`}
                                            cx="85" cy="40" r="10" 
                                        />
                                        {[1,2,3,4,5,6,7].map(h => (
                                            <circle 
                                                key={h}
                                                className={`flute-hole ${activeNoteIdx >= 0 && currentExercise.sequence[activeNoteIdx].n && FINGERINGS[currentExercise.sequence[activeNoteIdx].n][h] ? 'closed' : ''}`}
                                                cx="50" cy={30 + (h * 26)} r="10" 
                                            />
                                        ))}
                                    </svg>
                                </div>
                            </div>
                        </div>

                        {/* Ações Mobile */}
                        <div className="lg:hidden mt-auto py-10 flex flex-col gap-4">
                            {!isPlaying ? (
                                <button 
                                    onClick={startExercise}
                                    className="w-full bg-slate-800 text-white font-black py-5 rounded-[2rem] text-lg transition-all flex items-center justify-center gap-3 border border-slate-700"
                                >
                                    <Icon name="Volume2" size={24} /> {hasListened ? "OUVIR NOVAMENTE" : "OUVIR REFERÊNCIA"}
                                </button>
                            ) : (
                                <div className="w-full py-5 text-center font-black text-emerald-400 bg-emerald-500/5 rounded-[2rem] border-2 border-emerald-500/10 animate-pulse text-sm uppercase tracking-widest">
                                    Concentração Total
                                </div>
                            )}

                            {hasListened && !isPlaying && (
                                <button 
                                    onClick={() => setLessonComplete(true)}
                                    className="w-full bg-emerald-500 text-emerald-950 font-black py-6 rounded-[2rem] text-xl shadow-[0_6px_0_#059669] active:translate-y-1 transition-all flex items-center justify-center gap-3"
                                >
                                    <Icon name="ThumbsUp" size={28} fill="currentColor" /> ESTOU PRONTO
                                </button>
                            )}
                        </div>
                    </div>

                    <Modal isOpen={lessonComplete} onClose={() => setLessonComplete(false)} title="Objetivo Concluído" iconName="Trophy">
                        <div className="text-center py-6">
                            <div className="inline-block p-6 bg-emerald-500/10 text-emerald-400 rounded-full mb-8">
                                <Icon name="CheckCircle2" size={80} />
                            </div>
                            <h4 className="text-3xl font-black text-white mb-3">Lição Finalizada</h4>
                            <p className="text-slate-500 mb-12 leading-relaxed px-6 text-sm">
                                Excelente! Se você já conseguiu reproduzir o exercício com clareza, pode avançar para o próximo desafio técnico.
                            </p>
                            <div className="flex flex-col gap-4">
                                <button 
                                    onClick={nextLesson}
                                    className="w-full bg-emerald-500 hover:bg-emerald-400 text-emerald-950 font-black py-5 rounded-[1.5rem] transition-all shadow-xl text-lg"
                                >
                                    PRÓXIMO DESAFIO
                                </button>
                                <button 
                                    onClick={() => { setLessonComplete(false); startExercise(); }}
                                    className="w-full bg-slate-800 text-white font-bold py-5 rounded-[1.5rem] hover:bg-slate-700 transition-all flex items-center justify-center gap-3"
                                >
                                    <Icon name="RotateCcw" size={20} /> REPETIR REFERÊNCIA
                                </button>
                            </div>
                        </div>
                    </Modal>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
